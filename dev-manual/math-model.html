<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>8. Mathematical Model Object &mdash; MATPOWER Documentation 8.0b1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../_static/css/matpower.css?v=f6466fd7" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=d50bc636"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>window.MathJax = {"loader": {"load": ["[tex]/upgreek"]}, "tex": {"packages": {"[+]": ["upgreek"]}, "macros": {"dg": "\\sp\\dagger", "trans": ["{#1}^{\\mathsf{T}}", 1], "conj": ["{#1}^{\\ast}", 1], "hc": ["{#1}^{\\dg}", 1], "hconj": ["{#1}^{+}", 1], "diag": ["\\left[^\\smallsetminus{#1}_\\smallsetminus\\right]", 1], "diagg": ["\\left[\\smash{#1}\\right]", 1], "cdiag": ["\\conj{\\diag{#1}}", 1], "der": ["\\frac{\\partial{#1}}{\\partial{#2}}", 2], "dersx": ["\\frac{\\partial^2{#1}}{\\partial{#2}^2}", 2], "dersxy": ["\\frac{\\partial^2{#1}}{\\partial{#2}\\partial{#3}}", 3], "cscal": ["\\mathrm{#1}", 1], "rvec": ["{\\boldsymbol{#1}}", 1], "cvec": ["\\mathbf{#1}", 1], "rmat": ["{\\boldsymbol{#1}}", 1], "cmat": ["\\mathbf{#1}", 1], "rvecG": ["{\\boldsymbol{#1}}", 1], "cvecG": ["\\boldsymbol{#1}", 1], "rmatG": ["\\boldsymbol{\\mathit{#1}}", 1], "cmatG": ["\\mathbf{#1}", 1], "param": ["\\underline{#1}", 1], "ov": ["{\\overline{#1}}", 1], "zeros": ["\\rvec{0}", 0], "ones": ["\\rvec{1}_{#1}", 1], "onest": ["\\trans{\\rvec{1}}_{#1}", 1], "Id": ["\\diag{\\ones{#1}}", 1], "R": "\\mathbb{R}}         % requires \\usepackage{amsfonts|bbold", "C": "\\mathbb{C}}         % requires \\usepackage{amsfonts", "av": "\\cvec{a}", "bv": "\\cvec{b}", "cv": "\\cvec{c}", "f": "\\cscal{f}", "F": "\\cvec{f}", "g": "\\rvec{g}", "G": "\\cvec{g}", "h": "\\rvec{h}", "HH": "\\cvec{h}", "x": "\\rvec{x}", "y": "\\rvec{y}", "z": "\\rvec{z}", "X": "\\cvec{x}", "Z": "\\cvec{z}", "A": "\\cmat{A}", "B": "\\cmat{B}", "alphav": "\\rvecG{\\alpha}", "lam": "\\rvecG{\\lambda}", "lamh": "\\hat{\\lam}", "muv": "\\rvecG{\\mu}", "muhv": "\\hat{\\muv}", "vv": "\\rvec{v}", "vvi": ["\\cscal{v}_{#1}", 1], "V": "\\cvec{v}", "Vh": "\\hat{\\V}", "Vc": "\\conj{\\V}", "Vhc": "\\conj{\\Vh}", "dV": "\\diag{\\V}", "dVh": "\\diag{\\Vh}", "dVc": "\\diag{\\Vc}", "dVhc": "\\diag{\\Vhc}", "inV": "\\cvec{\\Lambda}", "inVh": "\\hat{\\inV}", "inVc": "\\conj{\\inV}", "inVhc": "\\conj{\\inVh}", "dinV": "\\diagg{\\inV}", "dinVh": "\\diagg{\\inVh}", "dinVc": "\\diagg{\\inVc}", "dinVhc": "\\diagg{\\inVhc}", "va": ["\\theta", 0], "vai": ["\\va_{#1}", 1], "Va": ["\\rvec{\\va}", 0], "Vah": ["\\hat{\\Va}", 0], "vm": ["\\nu", 0], "vmi": ["\\nu_{#1}", 1], "Vm": ["\\rvecG{\\nu}", 0], "dVm": "\\diag{\\Vm}", "dVmi": "\\dVm^{-1}", "Vmh": "\\hat{\\Vm}", "dVmh": "\\diag{\\Vmh}", "dVmhi": "\\dVmh^{-1}", "vr": "u", "vri": ["u_{#1}", 1], "vi": "w", "vii": ["w_{#1}", 1], "Vr": "\\rvec{u}", "Vi": "\\rvec{w}", "dVr": "\\diag{\\Vr}", "dVi": "\\diag{\\Vi}", "Vrh": "\\hat{\\Vr}", "Vih": "\\hat{\\Vi}", "dVrh": "\\diag{\\Vrh}", "dVih": "\\diag{\\Vih}", "E": "\\cvec{e}", "Eh": "\\hat{\\E}", "Ec": "\\conj{\\E}", "Ehc": "\\conj{\\Eh}", "dE": "\\diag{\\E}", "dEh": "\\diag{\\Eh}", "dEc": "\\diag{\\Ec}", "dEhc": "\\diag{\\Ehc}", "zr": "{z_r}", "zi": "{z_i}", "Zr": "{\\rvec{z}_r}", "Zi": "{\\rvec{z}_i}", "dlam": "\\diagg{\\lam}", "dlamh": "\\diagg{\\lamh}", "dlamva": "\\diagg{\\lam_\\va}", "dlamvm": "\\diagg{\\lam_\\vm}", "dlamvr": "\\diagg{\\lam_\\vr}", "dlamvi": "\\diagg{\\lam_\\vi}", "dlamzr": "\\diagg{\\lam_\\zr}", "dlamzi": "\\diagg{\\lam_\\zi}", "dlamhva": "\\diagg{\\lamh_\\va}", "dlamhvm": "\\diagg{\\lamh_\\vm}", "dlamhvr": "\\diagg{\\lamh_\\vr}", "dlamhvi": "\\diagg{\\lamh_\\vi}", "dlamhzr": "\\diagg{\\lamh_\\zr}", "dlamhzi": "\\diagg{\\lamh_\\zi}", "dmu": "\\diag{\\muv}", "dmuh": "\\diag{\\muhv}", "kk": "\\rvec{k}", "J": "\\param{\\rmat{J}}", "Jt": "\\trans{\\J}", "Jk": ["\\J_{\\kk_#1}", 1], "Ah": "\\hat{\\A}", "Fh": "\\hat{\\F}", "Gh": "\\hat{\\G}", "gh": "\\hat{\\g}", "fmax": "\\param{\\rvec{f}}_\\mathrm{max}", "gP": "\\g^P", "gPk": ["\\g^{P,#1}", 1], "fhmax": "\\hat{\\param{\\rvec{f}}}_\\mathrm{max}", "ghP": "\\gh^P", "ghPk": ["\\gh^{P,#1}", 1], "GS": "\\G^S", "GI": "\\G^I", "GSk": ["\\G^{S,#1}", 1], "GIk": ["\\G^{I,#1}", 1], "GSsys": "\\GSk{\\mathrm{sys}}", "GIsys": "\\GIk{\\mathrm{sys}}", "gPsys": "\\gPk{\\mathrm{sys}}", "GhS": "\\Gh^S", "GhI": "\\Gh^I", "GhSk": ["\\Gh^{S,#1}", 1], "GhIk": ["\\Gh^{I,#1}", 1], "GhSsys": "\\GhSk{\\mathrm{sys}}", "GhIsys": "\\GhIk{\\mathrm{sys}}", "ghPsys": "\\ghPk{\\mathrm{sys}}", "Ilin": "\\cvec{i}^{lin}", "Ilink": "\\cvec{i}^{lin, k}", "Ilinc": "\\conj{\\Ilin}", "dIlin": "\\diag{\\Ilin}", "dIlinc": "\\diag{\\Ilinc}", "Ilinh": "\\hat{{\\cvec{i}}}^{lin}", "Ilinhk": "\\hat{\\cvec{i}}^{lin, k}", "Ilinhc": "\\conj{\\Ilinh}", "dIlinh": "\\diag{\\Ilinh}", "dIlinhc": "\\diag{\\Ilinhc}", "Slin": "\\cvec{s}^{lin}", "Slink": "\\cvec{s}^{lin, k}", "Slinc": "\\conj{\\Slin}", "dSlin": "\\diag{\\Slin}", "dSlinc": "\\diag{\\Slinc}", "Slinh": "\\hat{\\cvec{s}}^{lin}", "Slinhk": "\\hat{\\cvec{s}}^{lin, k}", "Slinhc": "\\conj{\\Slinh}", "dSlinh": "\\diag{\\Slinh}", "dSlinhc": "\\diag{\\Slinhc}", "Inln": "\\cvec{i}^{nln}", "Inlnk": "\\cvec{i}^{nln, k}", "Snln": "\\cvec{s}^{nln}", "Snlnk": "\\cvec{s}^{nln, k}", "Inlnh": "\\hat{\\cvec{i}}^{nln}", "Inlnhk": "\\hat{\\cvec{i}}^{nln, k}", "Snlnh": "\\hat{\\cvec{s}}^{nln}", "Snlnhk": "\\hat{\\cvec{s}}^{nln, k}", "Aa": "\\param{\\rmat{A}}", "BB": "\\param{\\rmat{B}}", "CC": "\\param{\\rmat{C}}", "DD": "\\param{\\rmat{D}}", "YY": "\\param{\\cmat{Y}}", "iv": "\\param{\\cvec{i}}", "pv": "\\param{\\rvec{p}}", "sv": "\\param{\\cvec{s}}", "KK": "\\param{\\rmat{K}}", "LL": "\\param{\\cmat{L}}", "MM": "\\param{\\cmat{M}}", "NN": "\\param{\\cmat{N}}", "BBh": "\\hat{\\BB}", "YYh": "\\hat{\\YY}", "ivh": "\\hat{\\iv}", "pvh": "\\hat{\\pv}", "svh": "\\hat{\\sv}", "CCh": "\\hat{\\CC}", "KKh": "\\hat{\\KK}", "LLh": "\\hat{\\LL}", "MMh": "\\hat{\\MM}", "NNh": "\\hat{\\NN}", "AT": "\\trans{\\Aa}", "CT": "\\trans{\\CC}", "DT": "\\trans{\\DD}", "Ap": "\\Aa'", "Cp": "\\CC\\:\\!'", "Dp": "\\DD'", "ApT": "\\trans{\\Ap}", "CpT": "\\trans{\\Cp}", "DpT": "\\trans{\\Dp}", "ChT": "\\trans{\\CCh}", "Lc": "\\conj{\\LL}", "LcT": "\\trans{\\Lc}", "Lhc": "\\conj{\\LLh}", "LhcT": "\\trans{\\Lhc}", "MT": "\\trans{\\MM}", "Mc": "\\conj{\\MM}", "McT": "\\trans{\\Mc}", "dMTlam": "\\diag{\\MT \\lam}", "MhT": "\\trans{\\MMh}", "Mhc": "\\conj{\\MMh}", "MhcT": "\\trans{\\Mhc}", "dMhTlam": "\\diag{\\MhT \\lamh}", "Nc": "\\conj{\\NN}", "NcT": "\\trans{\\Nc}", "Nhc": "\\conj{\\NNh}", "NhcT": "\\trans{\\Nhc}", "YT": "\\trans{\\YY}", "Yc": "\\conj{\\YY}", "YcT": "\\trans{\\Yc}", "dYTlam": "\\diag{\\YT \\lam}", "YhT": "\\trans{\\YYh}", "Yhc": "\\conj{\\YYh}", "YhcT": "\\trans{\\Yhc}", "dYhTlam": "\\diag{\\YhT \\lamh}", "I": "\\cvec{i}^S", "s": "\\cvec{s}^I", "Ih": "\\hat{\\cvec{i}}^S", "Sh": "\\hat{\\cvec{s}}^I", "AtX": "\\AT \\X", "CtV": "\\CT \\V", "dCtV": "\\diag{\\CtV}", "DtZ": "\\DT \\Z", "ApTx": "\\ApT \\x", "CpTv": "\\CpT \\vv", "DpTz": "\\DpT \\z"}}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="9. Customizing MATPOWER" href="customizing.html" />
    <link rel="prev" title="7. Network Model Object" href="net-model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #568085" >

          
          
          <a href="../index.html" class="icon icon-home">
            MATPOWER Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Home</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://matpower.org">matpower.org</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://matpower.org/about/get-started/">Get Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manuals</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../users-manual/index.html"><span class="raw-html">M<span style="font-size:smaller">ATPOWER</span></span> User’s Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html"><span class="raw-html">M<span style="font-size:smaller">ATPOWER</span></span> Developer’s Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="notation.html">2. Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">3. Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="task.html">4. Task Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-model.html">5. Data Model Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-model-converter.html">6. Data Model Converter Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="net-model.html">7. Network Model Object</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">8. Mathematical Model Object</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mathematical-models">8.1. Mathematical Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#building-a-mathematical-model">8.1.1. Building a Mathematical Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solving-a-math-model">8.1.2. Solving a Math Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating-network-and-data-models">8.1.3. Updating Network and Data Models</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mathematical-model-elements">8.2. Mathematical Model Elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adding-variables-constraints-and-costs">8.2.1. Adding Variables, Constraints, and Costs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating-data-model-elements">8.2.2. Updating Data Model Elements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#shared-classes">8.3. Shared Classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customizing.html">9. Customizing <span class="raw-html">M<span style="font-size:smaller">ATPOWER</span></span></a></li>
<li class="toctree-l2"><a class="reference internal" href="acknowledgments.html">10. Acknowledgments</a></li>
<li class="toctree-l2"><a class="reference internal" href="references.html">11. References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ref-manual/index.html"><span class="raw-html">M<span style="font-size:smaller">ATPOWER</span></span> Reference Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mptest/index.html">MP-Test User’s Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mips/index.html">MIPS User’s Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mpom/index.html"><span class="raw-html">MP-Opt-Model</span> User’s Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../most/index.html">MOST User’s Manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://matpower.org/doc/manuals/">All Legacy PDF Manuals</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How To Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howto/element.html">How to Create a New Element Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/add-constraint.html">How to Add an OPF Constraint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/extension.html">How to Create an Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/three-phase.html">How to Run a Three-Phase Power Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/builddocs.html">How to Build the Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tech Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tech-notes.html"><span class="raw-html">M<span style="font-size:smaller">ATPOWER</span></span> Technical Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://matpower.org/sponsor">Donate</a></li>
<li class="toctree-l1"><a class="reference external" href="https://matpower.org/download">Downloads</a></li>
<li class="toctree-l1"><a class="reference external" href="http://github.com/MATPOWER/matpower">GitHub Project</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #568085" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MATPOWER Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="raw-html">M<span style="font-size:smaller">ATPOWER</span></span> Developer’s Manual</a></li>
      <li class="breadcrumb-item active"><span class="section-number">8. </span>Mathematical Model Object</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/dev-manual/math-model.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="net-model.html" class="btn btn-neutral float-left" title="7. Network Model Object" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="customizing.html" class="btn btn-neutral float-right" title="9. Customizing MATPOWER" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mathematical-model-object">
<span id="sec-math-model"></span><h1><span class="section-number">8. </span>Mathematical Model Object<a class="headerlink" href="#mathematical-model-object" title="Link to this heading"></a></h1>
<p>The mathematical model, or math model, formulates and defines the mathematical problem to be solved. That is, it determines the variables, constraints, and objective that define the problem. This takes on different forms depending on the task and the formulation.</p>
<dl>
<dt>Power Flow</dt><dd><p>The <em>power flow</em> problem involves solving a system of nonlinear equations for the vector <span class="math notranslate nohighlight">\(\x\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-pf-ac-form">
<span class="eqno">(8.1)<a class="headerlink" href="#equation-eq-pf-ac-form" title="Link to this equation"></a></span>\[\rvec{f}(\x) = \rvec{0}\]</div>
<p>For the DC version, the function <span class="math notranslate nohighlight">\(\rvec{f}(\x)\)</span> is linear, so the problem takes the more specific form,</p>
<div class="math notranslate nohighlight" id="equation-eq-pf-dc-form">
<span class="eqno">(8.2)<a class="headerlink" href="#equation-eq-pf-dc-form" title="Link to this equation"></a></span>\[\param{\rmat{A}} \x - \param{\rvec{b}} = \rvec{0}.\]</div>
</dd>
<dt>Continuation Power Flow</dt><dd><p>The <em>continuation power flow</em> problem involves tracing the solution curve for a parameterized system of equations, as the parameter <span class="math notranslate nohighlight">\(\lambda\)</span> is varied.</p>
<div class="math notranslate nohighlight" id="equation-eq-cpf-form">
<span class="eqno">(8.3)<a class="headerlink" href="#equation-eq-cpf-form" title="Link to this equation"></a></span>\[\rvec{f}(\x, \lambda) = \rvec{0},\]</div>
</dd>
<dt>Optimal Power Flow</dt><dd><p>The <em>optimal power flow</em> problem, on the other hand, is a constrained  optimization problem of the form,</p>
<div class="math notranslate nohighlight" id="equation-eq-opf-ac-form">
<span class="eqno">(8.4)<a class="headerlink" href="#equation-eq-opf-ac-form" title="Link to this equation"></a></span>\[\begin{split}\min_\x \rvec{f}(\x) \\
\textrm{such that} \qquad \rvec{g}(\x) &amp;= \rvec{0} \\
\rvec{h}(\x) &amp;\le \rvec{0} \\
\param{\x}_{\min} \le \x &amp;\le \param{\x}_{\max}.\end{split}\]</div>
<p>This reduces to a simple quadratic program (QP) for the DC OPF case,</p>
<div class="math notranslate nohighlight" id="equation-eq-opf-dc-form">
<span class="eqno">(8.5)<a class="headerlink" href="#equation-eq-opf-dc-form" title="Link to this equation"></a></span>\[\begin{split}\min_\x \trans{\x} \param{\rmat{Q}} \x &amp;+ \trans{\param{\rvec{c}}} \x + \param{k} \\
\textrm{such that} \qquad \param{\rvec{l}} &amp;\le \param{\rmat{A}} \x \le \param{\rvec{u}} \\
\param{\x}_{\min} &amp; \le \x \le \param{\x}_{\max}.\end{split}\]</div>
</dd>
</dl>
<section id="mathematical-models">
<h2><span class="section-number">8.1. </span>Mathematical Models<a class="headerlink" href="#mathematical-models" title="Link to this heading"></a></h2>
<p>A math model object is a container for math model element objects and it is also an <span class="raw-html"><a href="https://github.com/MATPOWER/mp-opt-model">MP-Opt-Model</a></span> object. All math model classes inherit from <a class="reference internal" href="../ref-manual/classes/mp/math_model.html#mp.math_model" title="mp.math_model"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp.math_model</span></code></a> and therefore also from <a class="reference internal" href="../ref-manual/classes/mp/element_container.html#mp.element_container" title="mp.element_container"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp.element_container</span></code></a>, <a class="reference internal" href="../mpom/classes/opt_model.html#opt_model" title="opt_model"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">opt_model</span></code></a>, and  <a class="reference internal" href="../mpom/classes/mp_idx_manager.html#mp_idx_manager" title="mp_idx_manager"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp_idx_manager</span></code></a>. Concrete math model classes are task and formulation specific as illustrated in <a class="reference internal" href="#fig-math-model-classes"><span class="std std-numref">Figure 8.1</span></a>, and sometimes inherit from abstract mix-in classes that are shared across tasks or formulations. These shared classes are described further in <a class="reference internal" href="#sec-math-model-shared"><span class="std std-numref">Section 8.3</span></a>.</p>
<figure class="align-center" id="id1">
<span id="fig-math-model-classes"></span><img alt="Math Model Classes" src="../_images/math-model-classes.png" />
<figcaption>
<p><span class="caption-number">Figure 8.1 </span><span class="caption-text">Math Model Classes</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>By convention, math model variables are named <code class="docutils literal notranslate"><span class="pre">mm</span></code> and math model class names begin with <code class="docutils literal notranslate"><span class="pre">mp.math_model</span></code>.</p>
<section id="building-a-mathematical-model">
<h3><span class="section-number">8.1.1. </span>Building a Mathematical Model<a class="headerlink" href="#building-a-mathematical-model" title="Link to this heading"></a></h3>
<p>A math model object is created in two steps. The first is to call the constructor of the desired math model class, without arguments. This initializes the <a class="reference internal" href="../ref-manual/classes/mp/element_container.html#mp.element_container.element_classes" title="mp.element_container.element_classes"><code class="xref mat mat-attr docutils literal notranslate"><span class="pre">element_classes</span></code></a> property with a list of math model element classes. This list can be modified before the second step, which is to call the <a class="reference internal" href="../ref-manual/classes/mp/math_model.html#mp.math_model.build" title="mp.math_model.build"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">build()</span></code></a> method, passing in the network and data model objects and a <span class="raw-html">M<span style="font-size:smaller">ATPOWER</span></span> options struct.</p>
<div class="highlight-octave notranslate" id="code-math-model-build"><div class="highlight"><pre><span></span><span class="n">mm</span> <span class="p">=</span> <span class="n">mp</span><span class="p">.</span><span class="n">math_model_opf_acps</span><span class="p">();</span>
<span class="n">mm</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">mpopt</span><span class="p">);</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../ref-manual/classes/mp/math_model.html#mp.math_model.build" title="mp.math_model.build"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">build()</span></code></a> method proceeds through the following stages sequentially, looping through each element for the last 3 stages.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>Create</strong> – Instantiate each element object.</p></li>
<li><p><strong>Count and add</strong> - For each element object, determine the number of online elements from the corresponding data model element and, if nonzero, add the object to the <a class="reference internal" href="../ref-manual/classes/mp/element_container.html#mp.element_container.elements" title="mp.element_container.elements"><code class="xref mat mat-attr docutils literal notranslate"><span class="pre">elements</span></code></a> property of the <code class="docutils literal notranslate"><span class="pre">mm</span></code>.</p></li>
<li><p><strong>Add auxiliary data</strong> – Add auxiliary data, e.g. network node types, for use by the model.</p></li>
<li><p><strong>Add variables</strong> – Add variables and allow each element to add their own variables to the model.</p></li>
<li><p><strong>Add constraints</strong> – Add constraints and allow each element to add their own constraints to the model.</p></li>
<li><p><strong>Add costs</strong> – Add costs and allow each element to add their own costs to the model.</p></li>
</ol>
</div></blockquote>
<p>The adding of variables, constraints and costs to the model is done by the math model and model model element objects using the interfaces provided by <span class="raw-html"><a href="https://github.com/MATPOWER/mp-opt-model">MP-Opt-Model</a></span>.</p>
</section>
<section id="solving-a-math-model">
<h3><span class="section-number">8.1.2. </span>Solving a Math Model<a class="headerlink" href="#solving-a-math-model" title="Link to this heading"></a></h3>
<p>Once the math model build is complete and it contains the full set of variables, constraints and costs for the model, the solver options are initialized by calling the <a class="reference internal" href="../ref-manual/classes/mp/math_model.html#mp.math_model.solve_opts" title="mp.math_model.solve_opts"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">solve_opts()</span></code></a> method and then passed to the <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">solve()</span></code> method.</p>
<div class="highlight-octave notranslate" id="code-math-model-solve"><div class="highlight"><pre><span></span><span class="n">opt</span> <span class="p">=</span> <span class="n">mm</span><span class="p">.</span><span class="n">solve_opts</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">mpopt</span><span class="p">);</span>
<span class="n">mm</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="n">opt</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">solve()</span></code> method, also inherited from <span class="raw-html"><a href="https://github.com/MATPOWER/mp-opt-model">MP-Opt-Model</a></span>, invokes the appropriate solver based on the characteristics of the model and the options provided.</p>
</section>
<section id="updating-network-and-data-models">
<h3><span class="section-number">8.1.3. </span>Updating Network and Data Models<a class="headerlink" href="#updating-network-and-data-models" title="Link to this heading"></a></h3>
<p>The solved math model can then be used to update the solved state of the network and data models by calling the <a class="reference internal" href="../ref-manual/classes/mp/math_model.html#mp.math_model.network_model_x_soln" title="mp.math_model.network_model_x_soln"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">network_model_x_soln()</span></code></a> and <a class="reference internal" href="../ref-manual/classes/mp/math_model.html#mp.math_model.data_model_update" title="mp.math_model.data_model_update"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">data_model_update()</span></code></a> methods, respectively.</p>
<div class="highlight-octave notranslate" id="code-math-model-updates"><div class="highlight"><pre><span></span><span class="n">nm</span> <span class="p">=</span> <span class="n">mm</span><span class="p">.</span><span class="n">network_model_x_soln</span><span class="p">(</span><span class="n">nm</span><span class="p">);</span>
<span class="n">dm</span> <span class="p">=</span> <span class="n">mm</span><span class="p">.</span><span class="n">data_model_update</span><span class="p">(</span><span class="n">nm</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">mpopt</span><span class="p">);</span>
</pre></div>
</div>
<p>The math model’s <a class="reference internal" href="../ref-manual/classes/mp/math_model.html#mp.math_model.data_model_update" title="mp.math_model.data_model_update"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">data_model_update()</span></code></a> method cycles through the math model element objects, calling the <a class="reference internal" href="../ref-manual/classes/mp/mm_element.html#mp.mm_element.data_model_update" title="mp.mm_element.data_model_update"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">data_model_update()</span></code></a> for each element.</p>
</section>
</section>
<section id="mathematical-model-elements">
<span id="sec-mm-element"></span><h2><span class="section-number">8.2. </span>Mathematical Model Elements<a class="headerlink" href="#mathematical-model-elements" title="Link to this heading"></a></h2>
<p>A math model element object typically does not contain any data, but only the methods that are used to build the math model and update the corresponding data model element once the math model has been solved.</p>
<p>All math model element classes inherit from <a class="reference internal" href="../ref-manual/classes/mp/mm_element.html#mp.mm_element" title="mp.mm_element"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp.mm_element</span></code></a>. Each element type typically implements its own subclasses, which are further subclassed where necessary per task and formulation, as with the container class.</p>
<p>By convention, math model element variables are named <code class="docutils literal notranslate"><span class="pre">mme</span></code> and math model element class names begin with <code class="docutils literal notranslate"><span class="pre">mp.mme</span></code>. <a class="reference internal" href="#fig-math-model-element-classes"><span class="std std-numref">Figure 8.2</span></a> shows the inheritance relationships between a few example math model element classes. Here the <code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp.nme_bus_pf_acp</span></code> and <code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp.nme_bus_opf_acp</span></code> classes are used for PF and OPF problems, respectively, with an AC polar formulation. AC cartesian and DC formulations use their own respective task-specific subclasses. And each element type, has a similar set of task and formulation-specific subclasses, such as those for <a class="reference internal" href="../ref-manual/classes/mp/mme_gen.html#mp.mme_gen" title="mp.mme_gen"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp.mme_gen</span></code></a>.</p>
<figure class="align-center" id="id2">
<span id="fig-math-model-element-classes"></span><a class="reference internal image-reference" href="../_images/math-model-element-classes.png"><img alt="Math Model Element Classes" src="../_images/math-model-element-classes.png" style="width: 650px;" /></a>
<figcaption>
<p><span class="caption-number">Figure 8.2 </span><span class="caption-text">Math Model Element Classes</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="adding-variables-constraints-and-costs">
<h3><span class="section-number">8.2.1. </span>Adding Variables, Constraints, and Costs<a class="headerlink" href="#adding-variables-constraints-and-costs" title="Link to this heading"></a></h3>
<p>Both the <code class="docutils literal notranslate"><span class="pre">mm</span></code> container object and the <code class="docutils literal notranslate"><span class="pre">mme</span></code> element objects can add their own variables, costs and constraints to the model.</p>
<p>For a standard optimal power flow, for example, the optimization variables are added by the container object, since they are determined directly from state variables of the <em>(container)</em> network model object. Similarly, the nodal power or current balance constraints are added by the container since they are built directly from the port injection functions of the aggregate network model.</p>
<p>However, generator cost functions and any variables and constraints associated with piecewise linear generator costs are added by the appropriate subclass of <a class="reference internal" href="../ref-manual/classes/mp/mme_gen.html#mp.mme_gen" title="mp.mme_gen"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp.mme_gen</span></code></a>, since they relate only to generator model parameters. Similarly, branch flow and branch angle difference constraints are added by the appropriate subclass of <a class="reference internal" href="../ref-manual/classes/mp/mme_branch.html#mp.mme_branch" title="mp.mme_branch"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp.mme_branch</span></code></a>, since they are specific to branches and are completely independent of other element types.</p>
</section>
<section id="updating-data-model-elements">
<h3><span class="section-number">8.2.2. </span>Updating Data Model Elements<a class="headerlink" href="#updating-data-model-elements" title="Link to this heading"></a></h3>
<p>The data in the data model is stored primarily in its individual element objects, so it makes sense that the individual math model element objects would be responsible for extracting the math model solution data relevant to a given element and updating the corresponding data model element. This updating is performed by the <a class="reference internal" href="../ref-manual/classes/mp/mm_element.html#mp.mm_element.data_model_update" title="mp.mm_element.data_model_update"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">data_model_update()</span></code></a> method.</p>
<p>The updating of each data model element is done in two steps. First <a class="reference internal" href="../ref-manual/classes/mp/mm_element.html#mp.mm_element.data_model_update" title="mp.mm_element.data_model_update"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">data_model_update()</span></code></a> calls <a class="reference internal" href="../ref-manual/classes/mp/mm_element.html#mp.mm_element.data_model_update_off" title="mp.mm_element.data_model_update_off"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">data_model_update_off()</span></code></a> to handle any offline units (e.g. to zero out any solution values), then <a class="reference internal" href="../ref-manual/classes/mp/mm_element.html#mp.mm_element.data_model_update_on" title="mp.mm_element.data_model_update_on"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">data_model_update_on()</span></code></a> to handle the online units.</p>
<p>For example, updating the branch power flows and shadow prices on the flow and angle difference limits in the branch data model element is done by <a class="reference internal" href="../ref-manual/classes/mp/mm_element.html#mp.mm_element.data_model_update_on" title="mp.mm_element.data_model_update_on"><code class="xref mat mat-meth docutils literal notranslate"><span class="pre">data_model_update_on()</span></code></a> in the appropriate subclass of <a class="reference internal" href="../ref-manual/classes/mp/mme_branch.html#mp.mme_branch" title="mp.mme_branch"><code class="xref mat mat-class docutils literal notranslate"><span class="pre">mp.mme_branch</span></code></a>.</p>
</section>
</section>
<section id="shared-classes">
<span id="sec-math-model-shared"></span><h2><span class="section-number">8.3. </span>Shared Classes<a class="headerlink" href="#shared-classes" title="Link to this heading"></a></h2>
<p>In some cases, there is code shared between math model classes across differnt tasks, e.g. PF and CPF. In order to avoid code duplication, another hierarchy of abstract mix-in classes is used to implement methods for this shared functionality. By convention, the names of these classes begin with <code class="docutils literal notranslate"><span class="pre">mp.mm_shared_</span></code>.</p>
<p>For example, a method to evaluate the node balance equations and corresponding Jacobian are used by both the PF and CPF. Putting this method in a shared class, allows its functionality to be inherited by concrete math model classes for both PF and CPF.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="net-model.html" class="btn btn-neutral float-left" title="7. Network Model Object" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="customizing.html" class="btn btn-neutral float-right" title="9. Customizing MATPOWER" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 1996-2024, Power Systems Engineering Research Center (PSERC).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>